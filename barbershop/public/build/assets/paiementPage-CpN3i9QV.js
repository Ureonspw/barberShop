import{r as l,x as w,j as e,t as G}from"./app-CvuLb3Vv.js";import{A as I,C as a}from"./AuthenticatedLayoutcaissier-Da-n7tXx.js";import{u as A,w as E,j as c,d as y,e as C,v as z,s as u,x as _,f as k,y as B,p as h}from"./index-kRwWHyEk.js";import{a as O,b as H}from"./index-Dc8vIfrn.js";import"./ResponsiveNavLink-BWydkspo.js";import"./barberlogo-CCddF666.js";import"./transition-DKRl218_.js";import"./iconBase-wn5QK0Z3.js";function Y({salons:S,coiffeurs:x,clients:j,recentPaiements:p}){const[t,f]=l.useState(""),[F,g]=l.useState([]),[o,m]=l.useState(""),[v,d]=l.useState([]),{data:i,setData:n,post:R,processing:N,errors:b,reset:L}=w({nom_client:"",contacts_client:"",montant:"",mode_paiement:"",id_salon:"",id_coiffeur:""});l.useEffect(()=>{if(t){const s=x.filter(r=>r.id_salon===t);g(s)}else g([])},[t,x]),l.useEffect(()=>{if(o&&t){const s=j.filter(r=>r.id_salon===t&&r.nom.toLowerCase().includes(o.toLowerCase()));d(s)}else d([])},[o,t,j]);const q=s=>{s.preventDefault(),R(route("caissier.paiement"),{onSuccess:()=>{L(),f(""),m("")}})},P=s=>{n({...i,nom_client:s.nom,contacts_client:s.contacts||""}),m(""),d([])},T=s=>new Date(s).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),M=s=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(s),D=s=>{switch(s){case"especes":return e.jsx(H,{});case"carte":return e.jsx(c,{});case"cheque":return e.jsx(O,{});default:return e.jsx(c,{})}};return e.jsx(I,{children:e.jsx("div",{className:a.caissierPage,children:e.jsxs("div",{className:a.container,children:[e.jsxs("div",{className:a.header,children:[e.jsx("div",{className:a.headerTop,children:e.jsxs(G,{href:route("caissier"),className:a.backButton,children:[e.jsx(A,{}),"Retour au tableau de bord"]})}),e.jsx("h1",{children:"Nouveau Paiement"}),e.jsx("p",{children:"Traitez un nouveau paiement pour un client"})]}),Object.keys(b).length>0&&e.jsxs("div",{className:a.errorMessage,children:[e.jsx(E,{style:{marginRight:"8px"}}),Object.values(b).map((s,r)=>e.jsx("div",{children:s},r))]}),e.jsxs("div",{className:a.content,children:[e.jsxs("div",{className:a.paiementForm,children:[e.jsxs("h2",{className:a.formTitle,children:[e.jsx(c,{}),"Formulaire de Paiement"]}),e.jsxs("form",{onSubmit:q,children:[e.jsxs("div",{className:a.formGroup,children:[e.jsxs("label",{className:a.formLabel,children:[e.jsx(y,{style:{marginRight:"5px"}}),"Salon *"]}),e.jsxs("select",{className:a.formSelect,value:t,onChange:s=>{f(Number(s.target.value)),n("id_salon",s.target.value)},required:!0,children:[e.jsx("option",{value:"",children:"Sélectionnez un salon"}),S.map(s=>e.jsxs("option",{value:s.id_salon,children:[s.nom," - ",s.adresse]},s.id_salon))]})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsxs("label",{className:a.formLabel,children:[e.jsx(C,{style:{marginRight:"5px"}}),"Coiffeur *"]}),e.jsxs("select",{className:a.formSelect,value:i.id_coiffeur,onChange:s=>n("id_coiffeur",s.target.value),required:!0,disabled:!t,children:[e.jsx("option",{value:"",children:"Sélectionnez un coiffeur"}),F.map(s=>e.jsxs("option",{value:s.id_coiffeur,children:[s.nom," - ",s.specialite]},s.id_coiffeur))]})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsxs("label",{className:a.formLabel,children:[e.jsx(z,{style:{marginRight:"5px"}}),"Rechercher un client existant"]}),e.jsx("input",{type:"text",className:a.formInput,placeholder:"Nom du client...",value:o,onChange:s=>m(s.target.value),disabled:!t}),v.length>0&&e.jsx("div",{className:a.clientSearchResults,children:v.map(s=>e.jsxs("div",{onClick:()=>P(s),className:a.clientSearchItem,children:[e.jsx(u,{style:{marginRight:"5px"}}),e.jsx("strong",{children:s.nom}),s.contacts&&e.jsxs(e.Fragment,{children:[e.jsx(_,{style:{marginLeft:"10px",marginRight:"5px"}}),s.contacts]})]},s.id_client))})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsxs("label",{className:a.formLabel,children:[e.jsx(u,{style:{marginRight:"5px"}}),"Nom du client *"]}),e.jsx("input",{type:"text",className:a.formInput,value:i.nom_client,onChange:s=>n("nom_client",s.target.value),placeholder:"Nom complet du client",required:!0})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsxs("label",{className:a.formLabel,children:[e.jsx(_,{style:{marginRight:"5px"}}),"Contacts (optionnel)"]}),e.jsx("input",{type:"text",className:a.formInput,value:i.contacts_client,onChange:s=>n("contacts_client",s.target.value),placeholder:"Téléphone ou email"})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsxs("label",{className:a.formLabel,children:[e.jsx(k,{style:{marginRight:"5px"}}),"Montant (FCFA) *"]}),e.jsx("input",{type:"number",step:"0.01",min:"0",className:a.formInput,value:i.montant,onChange:s=>n("montant",s.target.value),placeholder:"0.00",required:!0})]}),e.jsxs("div",{className:a.formGroup,children:[e.jsxs("label",{className:a.formLabel,children:[e.jsx(c,{style:{marginRight:"5px"}}),"Mode de paiement *"]}),e.jsxs("select",{className:a.formSelect,value:i.mode_paiement,onChange:s=>n("mode_paiement",s.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Sélectionnez le mode de paiement"}),e.jsx("option",{value:"especes",children:"Espèces"}),e.jsx("option",{value:"carte",children:"Carte bancaire"}),e.jsx("option",{value:"cheque",children:"Chèque"})]})]}),e.jsx("button",{type:"submit",className:a.submitButton,disabled:N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(B,{}),"Traitement..."]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{}),"Traiter le paiement"]})})]})]}),e.jsxs("div",{className:a.historiqueSection,children:[e.jsxs("h2",{className:a.historiqueTitle,children:[e.jsx(h,{}),"Paiements Récents"]}),p.length>0?p.map(s=>e.jsxs("div",{className:a.paiementCard,children:[e.jsxs("div",{className:a.paiementHeader,children:[e.jsxs("span",{className:a.clientName,children:[e.jsx(u,{style:{marginRight:"5px"}}),s.client.nom]}),e.jsx("span",{className:a.montant,children:M(s.somme_paiement)})]}),e.jsxs("div",{className:a.paiementDetails,children:[e.jsxs("div",{children:[e.jsx(C,{style:{marginRight:"5px"}}),e.jsx("strong",{children:"Coiffeur:"})," ",s.client.coiffeur.nom]}),e.jsxs("div",{children:[e.jsx(y,{style:{marginRight:"5px"}}),e.jsx("strong",{children:"Salon:"})," ",s.salon.nom]}),e.jsxs("div",{children:[e.jsx(h,{style:{marginRight:"5px"}}),e.jsx("strong",{children:"Date:"})," ",T(s.date_paiement)]}),e.jsx("div",{children:e.jsxs("span",{className:`${a.modePaiement} ${a.modePaiement[s.mode_paiement]}`,children:[D(s.mode_paiement),s.mode_paiement]})})]})]},s.id_paiement)):e.jsxs("div",{className:a.emptyState,children:[e.jsx(h,{size:64}),e.jsx("p",{children:"Aucun paiement récent"})]})]})]})]})})})}export{Y as default};
